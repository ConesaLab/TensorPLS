% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bestFittedModel.R
\name{bestfittedmodel}
\alias{bestfittedmodel}
\title{Grid search of Tucker-3 models over (P, Q, R)}
\usage{
bestfittedmodel(
  X,
  centering = 2,
  min_comp = 2,
  max_comp = 4,
  top_fit_n = NULL,
  verbose = TRUE
)
}
\arguments{
\item{X}{A 3D numeric array (subjects × variables × time or any 3-way layout).}

\item{centering}{Integer in \code{0,1,2,3}. Which mode to center:
\code{0} = no centering; \code{1,2,3} = center along the corresponding mode.
Delegated to \code{center_mode()}.}

\item{min_comp}{Integer (>= 1). Lower bound for \code{P, Q, R}.}

\item{max_comp}{Integer (>= min_comp). Upper bound for \code{P, Q, R}.}

\item{top_fit_n}{Optional integer. If > 0, also return the top-N triplets
by explained variance as \code{$top_by_fit}.}

\item{verbose}{Logical. If \code{TRUE}, prints a brief textual summary.}
}
\value{
A list with the following elements:
\item{summary}{A \code{data.frame} with one row per triplet and columns:
\code{P, Q, R, EXPL.VAR, SSE, DF, SSF, SumComp, Fitper}.}
\item{top_by_fit}{\code{data.frame} of top-N rows by \code{Fitper}, or \code{NULL}.}
\item{note}{Character note describing what was returned.}
}
\description{
Fits a Tucker-3 decomposition for all component triplets \code{(P, Q, R)}
within the given integer ranges and returns a complete summary table.
}
\details{
The function enumerates all triplets \code{P, Q, R} in
\code{min_comp:max_comp} and, for each candidate, runs
\code{tucker3mod2()} on a preliminarily centered and imputed array.
Results are collated into a single data frame including explained variance
and error metrics. Rows are ordered by increasing model complexity
(\code{SumComp = P + Q + R}) and then by decreasing explained variance.

A simple informative quantity \code{CriVal} is also returned
(\emph{not} a decision threshold): \code{norm(mat, "O") / (Smax - 3)},
where \code{mat} is a mode-1 unfolded version of the imputed tensor and
\code{Smax = max(P+Q+R)}.

Optionally, the \code{top_by_fit} element contains the top-\code{N} rows
with highest explained variance across the whole grid.
}
\section{Columns in \code{$summary}}{

\describe{
\item{P, Q, R}{Component counts along the three modes.}
\item{EXPL.VAR}{Explained variance (0–1).}
\item{SSE}{Sum of squared errors.}
\item{DF}{Total degrees of freedom used by the model.}
\item{SSF}{Sum of squares fitted.}
\item{SumComp}{\code{P + Q + R}.}
\item{Fitper}{Explained variance in percent: \code{EXPL.VAR * 100}.}
}
}

\examples{
\dontrun{
set.seed(1)
X <- array(rnorm(20*15*6), c(20,15,6))
out <- bestfittedmodel(X, centering = 2, min_comp = 2, max_comp = 4,
                              top_fit_n = 5, verbose = TRUE)
head(out$summary)
}
}
\seealso{
\code{\link{plot_bfm_pareto}}, \code{\link{plot_bfm_heatmap}}
}
